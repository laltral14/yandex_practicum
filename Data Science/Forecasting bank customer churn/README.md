# Прогнозирование оттока клиентов банка
<h1>Содержание<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Прогнозирование-оттока-клиентов-банка" data-toc-modified-id="Прогнозирование-оттока-клиентов-банка-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Прогнозирование оттока клиентов банка</a></span><ul class="toc-item"><li><span><a href="#Описание-проекта" data-toc-modified-id="Описание-проекта-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Описание проекта</a></span></li><li><span><a href="#Описание-данных" data-toc-modified-id="Описание-данных-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Описание данных</a></span></li><li><span><a href="#Вывод" data-toc-modified-id="Вывод-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Вывод</a></span></li></ul></li></ul></div>


Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling
## Описание проекта
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Мне предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.
## Описание данных
- RowNumber — индекс строки в данных
- CustomerId — уникальный идентификатор клиента
- Surname — фамилия
- CreditScore — кредитный рейтинг
- Geography — страна проживания
- Gender — пол
- Age — возраст
- Tenure — количество недвижимости у клиента
- Balance — баланс на счёте
- NumOfProducts — количество продуктов банка, используемых клиентом
- HasCrCard — наличие кредитной карты
- IsActiveMember — активность клиента
- EstimatedSalary — предполагаемая зарплата
- Exited — Целевой признак, факт ухода клиента

## Вывод
В рамках данного исследования были загружены и изучены данные об исторические поведении клиентов и расторжении договоров с банком. 
Были исследованы зависимости между категориальными и колличественными признаками: у клиентов из Германии в два раза больше процент ушедших клиентов чем у клиентом из других стран, среди активных клиентов банка процент ушедших клиентов меньше (14.3%) чем среди неактивных (26.8%). 
Были исследованы три типа моделей: модель решающего дерева, модель случайного леса и модель логистической регресии. Модели были обучены на тренировочной выборке и для каждого из типов моделей были найдены значения гиперпараметров, обеспечивабщие наибольшую долю правильных ответов на валидационной выборке. Наибольшее значение целевой метрики (F1-меры) показала модель случайного леса (значение F1-меры на валидационной выборке: 0.58; значение AUC-ROC на валидационной выборке: 0.86), что ниже поставленных условий (0.59). Для улучшения качества модели устранили дисбаланс классов посредством увеличения класса клиентов, прекративших обслуживание. Были проверены три типа моделей: модель решающего дерева, модель случайного леса и модель логистической регресии. Наибольшее значение целевой метрики (F1-меры) показала модель случайного леса (значение F1-меры на валидационной выборке: 0.60; значение AUC-ROC на валидационной выборке: 0.86), что выше поставленных условий (0.59). В дальнейшем для улувеличения целевой метрики (F1-меры) было подобрано значение порога классификации. Значение F1-меры увеличилось до 0.60; значение AUC-ROC осталось 0.86. Выбранная модель была проверена на тестовой выборке, где показатель значения F1-меры составило 0.63 (при подобраном значении порога классификации), значение AUC-ROC составило 0.86. Наша модель показала хорошие метрики и превысила целевое значение 0.59, а значит применение модели для задачи классификации (прогнозирования, ухода клиента из банка в ближайшее время) оправдана. В дальнейшем можно приступить к расчету экономического эффекта от внедрения модели.
